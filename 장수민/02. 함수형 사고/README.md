> 2장의 목표

- 현실적인 문제에 함수형 사고를 적용해 봅니다.
- 소프트웨어 구조를 잡는 데 계층형 설계가 좋은 이유를 설명합니다.
- 액션을 타임라인으로 시각화해 봅니다.
- 타임라인을 사용하면 시간에 관한 문제를 잘 풀 수 있다는 것을 배웁니다.

## 로봇이 피자를 만드는 일을 함수형 사고로 접근하기

1. 먼저, 액션과 계산, 데이터를 구분하기
2. 일급 추상

## 액션과 계산, 데이터

- 액션
  - 반죽 펴기
  - 피자 배달
  - 재료 주문
- 계산
  - 조리법에 나온 것을 두 배로 만들기
  - 쇼핑 목록 결정
- 데이터
  - 고객 주문
  - 영수증
  - 조리

## 변경 가능성에 따라 코드 나누기 - 계층화 설계

자주 바뀌지 않는 것은 아래에, 자주 바뀌는 것은 위에 위치하도록 도식화 한다.

이러한 아키텍처 패턴은 계층을 만들기 때문에 계층형 설계라고 부르고, 일반적으로 `비즈니스 규칙`, `도메인 규칙`, `기술 스택` 계층으로 나눈다.

## 타임라인 다이어그램 사용하기

액션은 실행 시점에 의존하기 때문에 실행 순서를 지켜야 한다.

액션을 실행 순서에 따라 나열한 도식을 활용한다.

## 확장성을 위해 분산 시스템을 도입하고 타임라인으로 시각화하기

책에서는 고객 수가 많아져 하나의 로봇만으로 모든 피자를 만들기에는 느려서 여러 로봇이 동시에 일을 할 수 있도록 만들려고 한다.

하나의 로봇만을 사용할 때는 타임라인 다이어그램이 직렬 형태였지만, 로봇 세 대가 각자의 타임라인을 가지고 동시에 일을 하도록 하려면 실행 순서가 섞이게 된다. → **실행 순서의 오류가 발생할 가능성이 높아진다.**

## 타임라인 커팅 기술 사용하기

세 개의 로봇으로 이루어진 분산 시스템에서 여러 타임라인이 동시에 진행될 때 오류를 피하기 위해 서로 순서를 맞춰야 할 필요가 있다.

타임라인 다이어그램에서 `컷(점선)`을 활용해서 컷 위에 있는 각기 다른 타임라인의 작업이 끝날 때까지 기다렸다가 아래 작업을 수행한다.

컷이 있기 때문에 작업들의 실행 순서나 시간을 신경 쓰지 않고 작업을 수행할 수 있다.

---

## 질문

- 함수의 실행 순서를 보장하기 위해 `async`, `await`를 사용하는 것처럼, 타임라인 커팅 기술을 실제 코드로 옮길 때 async, await를 사용해볼 수 있을지 궁금하다.
