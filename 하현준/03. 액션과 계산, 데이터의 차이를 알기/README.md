## ì•¡ì…˜ê³¼ ê³„ì‚°, ë°ì´í„°ëŠ” ì–´ë””ì—ë‚˜ ì ìš©í•  ìˆ˜ ìˆë‹¤.

ì¥ë³´ê¸° ê³¼ì •ì„ ì˜ˆë¥¼ ë“ ë‹¤ë©´, ê° ë‹¨ê³„ëŠ” ëª¨ë‘ ì•¡ì…˜ì— í•´ë‹¹í•œë‹¤.

```jsx
ëƒ‰ì¥ê³  í™•ì¸í•˜ê¸° -> ìš´ì „í•´ì„œ ìƒì ìœ¼ë¡œ ê°€ê¸° -> í•„ìš”í•œ ê²ƒ êµ¬ì…í•˜ê¸° -> ìš´ì „í•´ì„œ ì§‘ìœ¼ë¡œ ì˜¤ê¸°
```

ê·¸ëŸ¬ë‚˜ ì•¡ì…˜ë³´ë‹¤ëŠ” ê³„ì‚°ê³¼ ë°ì´í„°ë¥¼ ì„ í˜¸í•˜ê¸° ë•Œë¬¸ì— ìš°ë¦¬ëŠ” ì•¡ì…˜ì—ì„œ ìˆ¨ì–´ìˆëŠ” ê³„ì‚°ì´ë‚˜ ë°ì´í„°ë¥¼ ì°¾ì•„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.

ex) `í•„ìš”í•œ ê²ƒì„ êµ¬ì…í•˜ê¸°`ì—ì„œ ë°ì´í„°ì™€ ê³„ì‚°ì„ ë¶„ë¦¬í•´ë‚´ê¸°

- ë°ì´í„°: `í˜„ì¬ ì¬ê³ `, `í•„ìš”í•œ ì¬ê³ `
- ê³„ì‚°: `ì¬ê³  â€˜ë¹¼ê¸°â€™`
- ë°ì´í„°: `ì¥ë³´ê¸° ëª©ë¡`
- ì•¡ì…˜: `ëª©ë¡ì— ìˆëŠ” ê²ƒ êµ¬ì…í•˜ê¸°`

(ì¥ë³´ê¸° ëª©ë¡ = í•„ìš”í•œ ì¬ê³  - í˜„ì¬ ì¬ê³ )

ì¦‰, í•„ìš”í•œ ê²ƒì„ êµ¬ì…í•˜ëŠ” í•˜ë‚˜ì˜ ì•¡ì…˜ì—ì„œ ì—¬ëŸ¬ê°œì˜ ë°ì´í„°ì™€ ê³„ì‚°ì„ ë§Œë“¤ì–´ì„œ ê°„ë‹¨í•œ ì•¡ì…˜ì„ ë§Œë“¤ê²Œ ëœ ê²ƒì´ë‹¤.

**ê³„ì† ë‚˜ëˆ„ë‹¤ ë³´ë©´ ì ì  ë” ë³µì¡í•´ì§„ë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆì§€ë§Œ, ì•¡ì…˜ì— ìˆ¨ì–´ ìˆëŠ” ë‹¤ë¥¸ ì•¡ì…˜ì´ë‚˜ ê³„ì‚° ë˜ëŠ” ë°ì´í„°ë¥¼ ë°œê²¬í•˜ê¸° ìœ„í•´ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ë§Œí¼ ë‚˜ëˆ„ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.**

**ğŸ’¡ì—¬ê¸°ì„œÂ ë°°ìš´ ê²ƒ**

1. ì•¡ì…˜ê³¼ ê³„ì‚°, ë°ì´í„°ëŠ” ì–´ë””ì—ë‚˜ ì ìš©í•  ìˆ˜ ìˆë‹¤.â­ï¸
2. ì•¡ì…˜ ì•ˆì—ëŠ” ê³„ì‚°ê³¼ ë°ì´í„°, ë˜ ë‹¤ë¥¸ ì•¡ì…˜ì´ ìˆ¨ì–´ ìˆì„ì§€ë„ ëª¨ë¥¸ë‹¤.â­ï¸â­ï¸
3. ê³„ì‚°ì€ ë” ì‘ì€ ê³„ì‚°ê³¼ ë°ì´í„°ë¡œ ë‚˜ëˆ„ê³  ì—°ê²°í•  ìˆ˜ ìˆë‹¤.â­ï¸
4. ë°ì´í„°ëŠ” ë°ì´í„°ë§Œ ì¡°í•©í•  ìˆ˜ ìˆë‹¤.â­ï¸
5. ê³„ì‚°ì€ ëŒ€ë¡œ â€˜ìš°ë¦¬ ë¨¸ë¦¬ì†ì—ì„œâ€™ ì¼ì–´ë‚œë‹¤. â­ï¸â­ï¸â­ï¸
    1. í˜„ì‹¤ì—ì„œ ì‚¬ëŒì˜ ë¨¸ë¦¿ì†ì—ì„œëŠ” ì‰½ê²Œ ìƒê°í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤ì´ ìˆì–´ ê³„ì‚°ì´ ì˜ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.
    (ex) ì¥ë³´ê¸° ëª©ë¡ë„ ì¬ê³ ë¥¼ ë‚˜ëˆ„ì–´ì„œ ì§ì ‘ ê³„ì‚°í•´ì„œ êµ¬ë§¤í•˜ì§€ ì•ŠëŠ”ë‹¤.

> **ë°ì´í„°ì— ëŒ€í•´ì„œ**

ë°ì´í„°ëŠ” **ì´ë²¤íŠ¸ì— ëŒ€í•œ ì‚¬ì‹¤**ì´ë‹¤. 
í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë¨¸ëŠ” ë°ì´í„° êµ¬ì¡°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë‘ ê°€ì§€ ì›ì¹™ì„ ì‚¬ìš©

1. copy-on-write: ë³€ê²½í•  ë•Œ ë³µì‚¬ë³¸ì„ ë§Œë“¦
2. defensive copy: ë³´ê´€í•˜ë ¤ëŠ” ë°ì´í„°ì˜ ë³µì‚¬ë³¸ì„ ë§Œë“¦

ì¥ì 
- ì§ë ¬í™”: ì§ë ¬í™”ëœ ë°ì´í„°ëŠ” ì½ê³  ì“°ê¸°ê°€ ì‰½ë‹¤.
- ë™ì¼ì„± ë¹„êµ: ë°ì´í„°ëŠ” ë¹„êµí•˜ê¸°ê°€ ì‰½ë‹¤.
- ììœ ë¡œìš´ í•´ì„

ë‹¨ì 
- í•´ì„ì´ í•­ìƒ í•„ìš”í•˜ë©°, í•´ì„í•˜ì§€ ì•Šì€ ë°ì´í„°ëŠ” ì“¸ëª¨ì—†ëŠ” ë°”ì´íŠ¸ì´ë‹¤.
> 

## ì¿ í° ì„œë¹„ìŠ¤ ì½”ë“œì— í•¨ìˆ˜í˜• ì‚¬ê³  ì ìš©í•˜ê¸°

ì´ë©”ì¼ë¡œ ì¿ í°ì„ êµ¬ë…ë°›ì„ ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì´ë‹¤.

ìš”êµ¬ ì‚¬í•­

- ì¿ í° ë“±ê¸‰ì€ â€˜badâ€™, â€˜goodâ€™, bestâ€™ ë“±ê¸‰ì„ ê°€ì§€ê³  ìˆë‹¤.
    - bad: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì¿ í°
    - good: ëª¨ë“  ì‚¬ìš©ìë“¤ì—ê²Œ ì „ë‹¬ë˜ëŠ” ì¿ í°
    - best: ì¶”ì²œì„ ë§ì´ í•œ ì‚¬ìš©ìë¥¼ ìœ„í•œ ì¿ í°
- 10ëª… ì´ìƒ ì¶”ì²œí•œ ì‚¬ìš©ìëŠ” ë” ì¢‹ì€ ì¿ í°ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

ì´ì œ ì´ëŸ¬í•œ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ”ë° ìˆì–´ì„œ í•„ìš”í•œ ì•¡ì…˜(A)ê³¼ ê³„ì‚°(C), ë°ì´í„°(D)ë¥¼ ë¶„ë¥˜í•´ë³´ì.

- ì´ë©”ì¼ ë³´ë‚´ê¸° **`A`**
- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ êµ¬ë…ì ê°€ì ¸ì˜¤ê¸° **`A`**
- ì¿ í°ì— ë“±ê¸‰ ë§¤ê¸°ê¸° **`D`**
- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¿ í° ì½ê¸° **`A`**
- ì´ë©”ì¼ ì œëª© **`D`**
- ì´ë©”ì¼ ì£¼ì†Œ **`D`**
- ì¶”ì²œ ìˆ˜ **`D`**
- ì–´ë–¤ ì´ë©”ì¼ì´ ì¿ í°ì„ ë°›ì„ì§€ ê²°ì •í•˜ê¸° **`C`**
- êµ¬ë…ì DB ë ˆì½”ë“œ **`D`**
- ì¿ í° DB ë ˆì½”ë“œ **`D`**
- ì¿ í° ëª©ë¡ DB ë ˆì½”ë“œ **`D`**
- êµ¬ë…ì ëª©ë¡ DB ë ˆì½”ë“œ **`D`**
- ì´ë©”ì¼ ë³¸ë¬¸ **`D`**

### ì¿ í° ë³´ë‚´ëŠ” ê³¼ì • êµ¬í˜„í•˜ê¸°

```tsx
// ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ êµ¬ë…ì ë°ì´í„°
type Subscriber = {
	email: string,
	rec_count: number
}
const subscriber: Subscriber = {
	email: 'sam@pmail.com',
	rec_count: 16
}

// ì¿ í° ë“±ê¸‰ì„ ê²°ì •í•˜ëŠ” í•¨ìˆ˜ 
function subCouponRank(subscriber: Subscriber) {
	if(subscriber.rec_counter >= 10) {
		return 'best';
	} else {
		return 'good';
	}
}

// ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ì¿ í° ë°ì´í„°
type Rank = 'bad' | 'good' | 'best';
type Coupon = {
	code: string,
	rank: Rank,
}
cosnt coupon = {
	code: '10PERCENT',
	rank: 'bad',
}

// íŠ¹ì • ë“±ê¸‰ì˜ ì¿ í° ëª©ë¡ì„ ì„ íƒí•˜ëŠ” ê³„ì‚°
function selectCouponByRank(coupons: Array<Coupon>, rank: Rank) {
	// ì±…ì˜ ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë³€í˜•í–ˆìŠµë‹ˆë‹¤.
	const ret = coupons.filter((coupon) => {
		return coupon.rank === rank;
	})
	return ret;
}

// ì´ë©”ì¼ ë°ì´í„°
type Message = {
	from: string,
	to: string,
	subject: string,
	body: string,
}
const message = { 
	from: 'newsletter@coupondog.co',
	to: 'sam@pmail.com',
	subject: 'Your weekly coupons inside',
	body: 'Here are your coupons ...',
}

// êµ¬ë…ìê°€ ë°›ì„ ì´ë©”ì¼ì„ ê³„íší•˜ëŠ” ê³„ì‚°
function emailForSubscriber(subscriber: Subscriber, goods: Array<Coupon>, bests: Array<Coupon>) {
	// ì¿ í°ì˜ ë“±ê¸‰
	const rank = subCouponRank(subscriber);
	// ì±…ì˜ ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë³€í˜•í–ˆìŠµë‹ˆë‹¤.
	return { 
		from: 'newsletter@coupondog.co',
		to: 'sam@pmail.com',
		subject: 'Your weekly coupons inside',
		body: `Here are the ${rank} coupons: ${(rank === 'best' ? bests : goods).join(", ")}`,
	}
}

// ë³´ë‚¸ ì´ë©”ì¼ ëª©ë¡ì„ ì¤€ë¹„í•˜ê¸°
function emailsForSubscribers(subscribers: Array<Subscriber>, goods: Array<Coupon>, bests: Array<Coupon>) {
	// ì±…ì˜ ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë³€í˜•í–ˆìŠµë‹ˆë‹¤.
	const emails = subscribers.map((subscribe) => {
		return emailForSubscriber(subscribe, goods, bests);
	})
	return emails;
} 

// ì´ë©”ì¼ ë³´ë‚´ê¸°ë¥¼ ìœ„í•œ ì•¡ì…˜
function sendIssue() {
	const coupons = fetchCouponsFromDB();
	const goodCoupons = selectCouponsByRank(coupons, 'good');
	const bestCoupons = selectCouponsByRank(coupons, 'best');
	const emails = emailsForSubscribers(subscribers, goodCoupons, bestCoupons);
	
	// ì±…ì˜ ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë³€í˜•í–ˆìŠµë‹ˆë‹¤.
	emails.forEach((email) => {
		emailSystem.send(email);	
	})
}
```

> **ê³„ì‚°ì— ëŒ€í•´ì„œ**

ê³„ì‚°ì€ **ì…ë ¥ê°’ìœ¼ë¡œ ì¶œë ¥ê°’**ì„ ë§Œë“œëŠ” ê²ƒì´ë‹¤. 
ë³´í†µ **`ìˆœìˆ˜ í•¨ìˆ˜`**ë¼ê³  ë¶€ë¥´ëŠ” ê²ƒ ì¤‘ì— í•˜ë‚˜ì´ë‹¤.

ì•¡ì…˜ ë³´ë‹¤ ê³„ì‚°ì´ ì¢‹ì€ ì 
- í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ë‹¤.
- ê¸°ê³„ì ì¸(ì •ì ì¸) ë¶„ì„ì€ ì‰½ë‹¤
- ê³„ì‚°ì€ ë¶„ì„ì´ ì‰½ë‹¤.

ë‹¨ì 
- ì‹¤í–‰í•˜ê¸° ì „ì— ì–´ë–¤ ì¼ì´ ë°œìƒí•  ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.
> 

## ì´ë¯¸ ìˆëŠ” ì½”ë“œì— í•¨ìˆ˜í˜• ì‚¬ê³  ì ìš©í•˜ê¸°

```tsx
type Affiliate = {
	sales: number;
	commission: number;
	bank_code: string;
}
function figurePayout(affiliate: Affiliate) {
	const owed = affiliate.sales * affiliate.commission;
	if (owed > 100) {
	// í•˜ë‚˜ì˜ ì•¡ì…˜ì´ ìˆë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤.
	 sendPayout(affiliate.bank_code, owed);
	}
}
 
function affiliatePayout(affiliates: Array<Affiliate>) {
	affiliates.forEach((affiliate) => {
		figurePayout(affiliate);
	})
 }
 
function main(affiliates: Array<Affiliate>) {
	affiliatePayout(affiliates);
}
```

ê·¸ëŸ¬ë‚˜ ìœ„ì˜ ì½”ë“œëŠ” í•˜ë‚˜ì˜ ì•¡ì…˜ì´ ì•„ë‹ˆë‹¤. 

í•¨ìˆ˜ ì•ˆì—ì„œ ì•¡ì…˜ì„ í˜¸ì¶œí•˜ê³  ìˆê¸° ë•Œë¬¸ì— í•¨ìˆ˜ ì „ì²´ê°€ ì•¡ì…˜ì´ê³ , ì´ë¥¼ íƒ€ê³  íƒ€ê³  ì˜¬ë¼ê°€ë©´ **ê²°êµ­ ëª¨ë“  í•¨ìˆ˜ê°€ ì•¡ì…˜**ì´ ë¼ë²„ë¦°ë‹¤.

> **ì•¡ì…˜ì— ëŒ€í•´ì„œ**

ì•¡ì…˜ì€ ì™¸ë¶€ ì„¸ê³„ì— ì˜í–¥ì„ ì£¼ê±°ë‚˜ ë°›ëŠ” ê²ƒì„ ë§í•œë‹¤. 
- **ìˆœì„œ**: ì–¸ì œ ì‹¤í–‰ë˜ëŠ”ì§€
- **ë°˜ë³µ**: ì–¼ë§ˆë‚˜ ì‹¤í–‰ë˜ëŠ”ì§€
ì•¡ì…˜ì€ ì¼ë°˜ì ìœ¼ë¡œ **ìˆœìˆ˜í•˜ì§€ ì•Šì€ í•¨ìˆ˜, ë¶€ìˆ˜ íš¨ê³¼ í•¨ìˆ˜**ë¼ê³  ë¶€ë¥¸ë‹¤.

ì•¡ì…˜ì€ ë‹¤ë£¨ê¸°ê°€ í˜ë“¤ì§€ë§Œ ê¼­ ì¨ì•¼ í•œë‹¤.
- ê°€ëŠ¥í•œ ì•¡ì…˜ì„ ì ê²Œ ì‚¬ìš©í•œë‹¤.
- ì•¡ì…˜ì€ ê°€ëŠ¥í•œ ì‘ê²Œ ë§Œë“ ë‹¤.
- ì•¡ì…˜ì´ ì™¸ë¶€ ì„¸ê³„ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì„ ì œí•œí•´ë¼.
- ì•¡ì…˜ì´ í˜¸ì¶œ ì‹œì ì— ì˜ì¡´í•˜ëŠ” ê²ƒì„ ì œí•œí•œë‹¤.
>