## 변경 가능성에 따라 코드 나누기

### 피자 가게 운영에 함수형 사고를 활용한 예시 알아보기

계층형 설계는일반적으로 **비지니스 규칙, 도메인 규칙, 기술 스택 계층**으로 나눈다.

| 피자 주방 레이어 | 창고 레이어 | 메인 레이어 | 자주 바뀌는 것 |
| --- | --- | --- | --- |
| 이번 주 메뉴 | 이번 주 사야 할 것 | 비지니스 규칙 |  |
| 피자 만들기 | 재료 목록 | 도메인 규칙 |  |
| 자바스크립트 | 자바스크립트 | 기술 스택 | 자주 바뀌지 않는 것 |

계층형 설계로 만든 코드는 테스트, 재사용, 유지보수가 쉽다.

**주방을 자동화하기**

```
주문 접수 → 반죽 만들기 → 반죽 펴기 → 소스 만들기 → 소스 뿌리기 → 치즈 갈기
 -> 치즈 뿌리기 -> 오븐에 넣기 -> 10분 기다리기 -> 서빙
```

타임라인 다이어그램을 사용하여 액션이 시간 순서에 따라 어떻게 실행되는지 확인할 수 있다.
액션은 **실행 시점에 의존하기 때문에 실행 순서가 중요**하다.

피자 하나를 로봇 한 대로 피자를 만드는 것보다 세 대가 동시에 일을 하면 더 빠르게 일할 수 있을거라 생각했지만,,

```
주문 접수 
**ㄴ** 로봇1: 반죽 만들기 
ㄴ 로봇2: 치즈 갈기
ㄴ 로봇3: 소스 만들기 → 반죽 펴기 → 소스 뿌리기 → 치즈 뿌리기 → 오븐에 넣기 → 10분 기다리기 → 서빙
```

로봇 각각 **순서가 보장되어 있지 않기 때문에** 엉뚱한 피자가 만들어질 가능성이 있다.

**즉, 타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행**된다. 
(각각의 로봇이 하나의 타임라인이라고 생각하면 된다.)

### 어떻게 고쳐야 할 것인가?

- 기본적으로 타임라인은 서로 시간을 맞추지 않는다.
- 액션이 실행되는 시간은 중요하지 않다.
- 드물지만 타이밍이 어긋나는 경우는 실제 일어난다.
- 타임라인 다이어그램으로 시스템의 문제를 알 수 있다.

**`커팅(cutting)`기술을 사용하기!**

타임라인 커팅은 고차 동작(high-order operation)으로 구현한다. 각 타임라인은 독립적으로 동작하고 완료되면 다른 타임라인이 끝나길 기다리기 때문에 언제 끝나도 상관이 없다.

```
주문 접수 
**ㄴ** 로봇1: 반죽 만들기 |
ㄴ 로봇2: 치즈 갈기  |
ㄴ 로봇3: 소스 만들기 | → 반죽 펴기 → 소스 뿌리기 → 치즈 뿌리기 → 오븐에 넣기 → 10분 기다리기 → 서빙
```

로봇 3개가 각각의 작업이 모두 끝난 뒤에 `반죽 펴기`를  실행하도록 하면 된다. 

### 타임라인에 대해 배운 것

1. 타임라인 커팅으로 서로 다른 작업들을 쉽게 이해할 수 있다.
2. 타임라인 다이어그램을 사용하면 **시간에 따라 진행하는 작업을 쉽게 이해**할 수 있다.
    1. 타임라인은 동시에 실행되는 분산 시스템을 시각화하기 좋다.
3. 타임라인 다이어그램은 유연하다.

> 💡 여기서 실무와 가깝게 생각한 나의 의견

커팅을 코드로 옮긴다면 무엇일까.. 생각했다.
고차 동작을 사용하여 커팅을 진행한다고 했으니 HOC인가..? 
뒤에 읽어봐야 알겠지만 나중에 알게되면 적어보기
>